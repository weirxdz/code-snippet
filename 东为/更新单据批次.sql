SELECT h.cSOCode,b.AutoID  ,b.cItemCode ,b.cItemName ,b.cItem_class ,b.cItem_CName ,b.isaleoutid  ,b.iSOsID ,h.cDefine11 ,h.cDefine12 
FROM SaleBillVouch h
LEFT JOIN SaleBillVouchs b ON h.SBVID = b.SBVID 
;
SELECT * FROM rdrecords32 r WHERE r.AutoID = 1000017803
;
-- 修改销售发票表体项目编码、项目名称
UPDATE SaleBillVouchs 
SET cItemCode = SaleBillVouch.cDefine11 ,cItemName = SaleBillVouch.cDefine12 ,cItem_CName = '工程项目'
FROM SaleBillVouchs
INNER JOIN SaleBillVouch ON  SaleBillVouchs.SBVID = SaleBillVouch.SBVID 
WHERE SaleBillVouchs.cItemCode <> SaleBillVouch.cDefine11
;
-- 应收单
SELECT *
FROM Ap_Vouchs b
INNER JOIN Ap_Vouch h ON b.cLink = h.cLink 
;

SELECT * FROM Ia_ValuationAss
;
-- 总账凭证检查
-- 总账制造费用取数
SELECT t.iyear ,t.iperiod ,t.iYPeriod ,t.inid ,t.ccode 科目编码,c.ccode_name 科目名称,t.cdept_id 部门编码,d.cDepName 部门名称,d.bDepEnd  是否末级部门,t.md  借方金额,t.mc 贷方金额,t.cdigest 摘要,t.coutsysname  来源系统 
FROM GL_accvouch t 
left JOIN Department d ON t.cdept_id = d.cDepCode 
left JOIN code c ON t.ccode = c.ccode AND c.iyear = t.iyear
WHERE 1= 1--LEFT(t.ccode ,4) = '5101'
AND t.iyear = 2023 AND t.iperiod = 12
;

-- 部门
SELECT d.cDepCode ,d.cDepName  FROM Department d ORDER BY D.cDepCode 
;

-- 
SELECT i.cInvCode ,i.cInvName ,i.cInvStd ,i.bInvBatch ,i.bCheckBatch  FROM Inventory i WHERE i.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102')
;--
--USE UFDATA_102_2023;
UPDATE Inventory SET bInvBatch = 1,bCheckBatch = 1 WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102')
;--
-- 库存期初
SELECT * FROM rdrecords34 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
-- 采购入库
SELECT r.cBatch ,r.* FROM rdrecords01 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords01 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
-- 其他入库
SELECT r.cBatch ,r.* FROM rdrecords08 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords08 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');

-- 其他出库单
SELECT r.cBatch ,r.* FROM rdrecords09 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords09 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');

-- 产成品入库
SELECT r.cBatch ,r.* FROM rdrecords10 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords10 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');

-- 材料出库
SELECT r.cBatch ,r.* FROM rdrecords11 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords11 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');

-- 销售出库
SELECT r.cBatch ,r.* FROM rdrecords32 r WHERE r.cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');
UPDATE rdrecords32 SET cBatch = '0100001' WHERE cInvCode IN ('5201030102','5201030033','5201030093','5201030098','5201030101','5201030103','5201030104','5201030105','5201030120','5201030121','5201030122','5201030123','5201030124','5201030125','5201030188','5201030189','5201030190','5201030191','5201010001','5201010002','5201010003','5201010004','5201010005','5201010006','5201010009','5201010048','5201030102');



SELECT b.AutoID ,i.cInvCode ,h.cSBVCode ,i.bInvBatch ,b.iBatch ,b.cBatch ,b.isaleoutid ,r2.cCode ,r.cBatch 
FROM SaleBillVouch h
LEFT JOIN SaleBillVouchs b ON h.SBVID = b.SBVID 
LEFT JOIN rdrecords32 r ON b.isaleoutid = r.AutoID 
LEFT JOIN rdrecord32 r2 ON r.ID = r2.ID 
INNER JOIN Inventory i ON b.cInvCode = i.cInvCode 
WHERE /*h.dDate >= '2024-01-01' AND h.dDate <= '2024-01-31' AND*/ r.cBatch IS NOT NULL AND b.cBatch IS NULL 
;
SELECT b.AutoID ,i.cInvCode ,h.cSBVCode ,i.bInvBatch ,b.iBatch ,b.cBatch ,b.isaleoutid ,r2.cCode ,r.cBatch 
FROM SaleBillVouch h
LEFT JOIN SaleBillVouchs b ON h.SBVID = b.SBVID 
LEFT JOIN rdrecords32 r ON b.isaleoutid = r.AutoID 
LEFT JOIN rdrecord32 r2 ON r.ID = r2.ID 
INNER JOIN Inventory i ON b.cInvCode = i.cInvCode 
WHERE b.AutoID IN (1000000573,1000000647,1000000648,1000000649,1000000650,1000000659,1000000660,1000000661,1000000662,1000000663,1000000664,1000000665,1000000666,1000000667,1000000668,1000000669,1000000670,1000000671,1000000672,1000000673,1000000676,1000000682,1000000842,1000000843,1000000844)
;


UPDATE SaleBillVouchs SET cBatch =  '0100001' WHERE AutoID IN (1000000573,1000000647,1000000648,1000000649,1000000650,1000000659,1000000660,1000000661,1000000662,1000000663,1000000664,1000000665,1000000666,1000000667,1000000668,1000000669,1000000670,1000000671,1000000672,1000000673,1000000676,1000000682,1000000842,1000000843,1000000844)